function initialiseState(){return"showNotification"in ServiceWorkerRegistration.prototype?"denied"===Notification.permission?void console.warn("The user has blocked notifications."):"PushManager"in window?void navigator.serviceWorker.ready.then(function(e){e.pushManager.getSubscription().then(function(e){var i=document.querySelector(".js-push-button");i.disabled=!1,e&&(sendSubscriptionToServer(e),i.textContent="Disable Push Messages",isPushEnabled=!0)})["catch"](function(e){console.warn("Error during getSubscription()",e)})}):void console.warn("Push messaging isn't supported."):void console.warn("Notifications aren't supported.")}function subscribe(){var e=document.querySelector(".js-push-button");e.disabled=!0,navigator.serviceWorker.ready.then(function(i){i.pushManager.subscribe().then(function(i){return isPushEnabled=!0,e.textContent="Disable Push Messages",e.disabled=!1,sendSubscriptionToServer(i)})["catch"](function(i){"denied"===Notification.permission?(console.warn("Permission for Notifications was denied"),e.disabled=!0):(console.error("Unable to subscribe to push.",i),e.disabled=!1,e.textContent="Enable Push Messages")})})}function sendSubscriptionToServer(e){$.post("http://vps98649.ovh.net/api/registration_id",{registration_id:e})}var isPushEnabled=!1;window.addEventListener("load",function(){var e=document.querySelector(".js-push-button");e.addEventListener("click",function(){isPushEnabled?unsubscribe():subscribe()}),"serviceWorker"in navigator?navigator.serviceWorker.register("/service-worker.js").then(initialiseState):console.warn("Service workers aren't supported in this browser.")});